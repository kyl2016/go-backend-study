package main

import (
	"fmt"
	"github.com/cpmech/gosl/la/mkl"
	"sync"
	"time"
)

func main() {
	//x := []float64{20, 10, 30, 123, 123}
	//y := []float64{-15, -5, -24, 666, 666, 666}

	x := []float64{1, -1.1212}
	y := []float64{2, 0.99999}

	x = []float64{-0.0171471, 0.0297846, -0.0783937, 0.0344659, -0.0123615, -0.01626, 0.00834311, -0.0131212, -0.0737021, 4.94058e-05, -0.0295938, -0.0375178, -0.00589015, -0.0987369, -0.0100861, -0.0495452, 0.0372468, 0.0223542, -0.0248803, -0.082314, -0.0363815, 0.0716982, -0.00636599, 0.115157, 0.0063867, 0.0512754, 0.0208855, -7.58288e-05, 0.0538642, 0.0682479, -0.0838593, -0.00861104, -0.00883072, -0.0507958, -0.00559831, 0.0520896, 0.00130107, 0.00808368, 0.00678698, -0.0151102, -0.0329421, 0.00127409, 0.0677626, -0.0885619, -0.0121525, 0.0388406, -0.0474348, -0.0283509, 0.00531573, 0.062828, 0.0204233, 0.0347214, 0.00650341, 0.0209573, 0.000961383, -0.00662436, 0.0138615, 0.0345118, 0.0697092, -0.000791458, 0.0484601, 0.0272089, 0.0123456, -0.0561579, 0.0128478, 0.00634787, -0.00798256, 0.0608229, -0.00798005, 0.120746, -0.0189326, 0.0783079, -0.0112193, 0.046667, 0.0295899, -0.0624849, -0.124728, 0.00555878, -0.016878, 0.014625, 0.0279958, 0.000402037, 0.0477066, -0.00460424, -0.0253392, -0.0320167, -0.0529004, -0.0229253, 0.0343391, -0.0616839, 0.0666866, 0.0144988, 0.0290018, 0.0212762, 0.035475, 0.00542536, 0.0545873, -0.0314021, -0.00240926, 0.0128215, -0.0672244, -0.0794786, -0.0331857, -0.00343452, -0.0740348, -0.0263932, -0.0200069, -0.0450306, -0.0134022, 0.00790044, 0.00848116, 0.0372897, -0.000965439, -0.0345475, 0.0274444, -0.0795713, 0.013695, -0.0463269, -0.07119, 0.000392504, -0.023657, 0.0663353, -0.053157, -0.0631605, 0.0186122, 0.0207092, -0.00495913, 0.038306, 0.00828956, 0.0375084, -0.0147441, -0.0299766, 0.0326492, 0.0315515, -0.100865, -0.051241, -0.0306122, 0.0357479, 0.0152679, 0.0767074, -0.034078, 0.0125329, 0.0623144, 0.0255483, -0.0349576, -0.00636306, -0.0091572, -0.0857235, 0.0147058, 0.0213435, 0.00918211, -0.0264534, -0.0174918, 0.042121, 0.0456522, -0.0467863, -0.0586724, -0.00362923, 0.0297368, -0.00128466, 0.0601085, -0.0407007, 0.00304022, 0.0427377, -0.0338262, 0.0209174, 0.0232725, -0.0635804, 0.00294901, -0.00688292, -0.035485, 0.00681437, 0.00419963, 0.0296707, -0.00966988, 0.0829466, 0.0987125, 0.0632617, 0.0186468, -0.0888392, -0.0319501, -0.138817, 0.000794682, 0.016008, -0.0229171, 0.0435127, 0.0192899, 0.0100671, 0.0160915, 0.0770807, 0.0210978, -0.0227231, 0.0213188, -0.0295822, -0.0496281, -0.0348551, 0.0130301, 0.00616363, -0.0528773, -0.00137729, -0.069117, 0.0572823, -0.0267041, -0.0236668, 0.0426983, 0.00557249, 0.0231821, -0.0574522, -0.0355684, -0.0263657, 0.0631605, 0.0202925, 0.000604569, 0.0577102, 0.0223738, 0.033917, -0.026992, -0.021749, -0.106903, 0.0216692, -0.030522, -0.0868955, -0.114403, -0.0154236, -0.0240191, -0.0736906, -0.025687, 0.053966, 0.0419866, -0.0191384, 0.0404638, 0.0509841, -0.0211946, -0.078684, -0.0189793, -0.0382228, -0.0133259, 0.0769548, -0.0232762, -0.0746178, 0.0372208, -0.00432725, -0.0737898, 0.0213405, 0.0274398, 0.02592, 0.0668217, 0.0601869, -0.00129789, -0.00758273, -0.0312531, 0.0161658, -0.0340317, -0.00453943, 0.0169883, -0.044012, 0.00568949, -0.0422528, 0.0255397, 0.0058966, 0.0464304, -0.0379761, -0.0185769, -0.0513068, 0.00520705, -0.0661553, -0.0693925, 0.0724979, -0.0370124, -0.0566514, 0.071927, 0.0148165, 0.0519497, 0.0605697, 0.0320238, 0.000505405, 0.0436917, 0.0645559, 0.0260267, -0.0118016, 0.0398527, -0.0362457, -0.0466475, -0.0736472, -0.0366584, -0.0266992, -0.0120547, 0.0260854, -0.0601956, -0.0351302, -0.0837961, -0.055995, -0.0217101, 0.00650347, 0.00601037, -0.0740694, 0.00353488, 0.0313742, 0.00895211, 0.00543229, 0.117694, -0.0519126, 0.0943572, -0.0217035, 0.0428975, -0.00795407, 0.0543104, -0.0617965, 0.0676821, 0.0506659, 0.0853076, 0.040125, 0.0353153, 0.0341825, 0.0673648, 0.00194593, -0.0537658, 0.0368877, -0.0555215, 0.00214208, 0.0628353, -0.0230826, 0.0159762, 0.0718393, -0.0353398, -0.0177154, -0.0522304, -0.0649052, -0.00381502, -0.0185878, 0.0230481, -0.0463684, 0.0311793, 0.0382167, -0.0476014, -0.0373729, -0.0984441, -0.0260586, 0.0489026, 0.0638859, 0.0475757, 0.0238389, -0.019363, -0.066169, 0.0679463, -0.0673361, -0.0437612, 0.00600675, 0.11779, -0.0202437, -0.0269992, 0.00462337, -0.0617419, -0.0334796, -0.084388, 0.0715167, 0.0305015, 0.000284642, 0.0273472, -0.0176894, -0.0440895, -0.0058093, -0.0380236, 0.0113413, 0.0255854, -0.00966855, 0.0632864, -0.00997986, -0.0513677, -0.0355007, 0.0202677, -0.0128693, -0.0222251, -0.0236273, 0.0438018, 0.049972, 0.000851075, -0.039514, -0.0980734, -0.0474352, 0.0402889, -0.00253022, 0.0129111, 0.0359259, 0.0446692, 0.0157924, -0.0319146, -0.0254299, 0.0388774, 0.0262729, 0.0153477, 0.0520895, 0.0154867, -0.00149737, -0.0574799, -0.00183617, 0.0835947, 0.0504391, -0.0276789, 0.0476432, -0.0398327, 0.0532539, -0.0217112, 0.0839872, -0.00940199, -0.0626493, -0.0145271, 0.0174366, -0.0422386, 0.042953, 0.000379637, 0.00689239, -0.0244376, 0.0507345, 0.0368854, -0.0109072, 0.0304436, 0.066979, -0.0422741, -0.0102804, -0.0497968, -0.00431522, 0.00114161, -0.0262222, -0.0389814, 0.0169792, 0.115477, 0.0337423, -0.0143487, 0.0528054, -0.0154762, 0.0499573, -0.0508829, -0.0336813, 0.00646144, 0.0229013, -0.0132276, 0.00992374, 0.0888671, 0.0234773, -0.0190414, 0.0322071, -0.0226155, -0.0109756, -0.0160802, 0.0307243, -0.0243819, 0.114929, -0.0106829, -0.0599759, -0.00924507, -0.0127293, 0.0348296, -0.0951476, -0.00835151, 0.0566157, 0.027921, 0.0178862, 0.00843341, -0.0118943, -0.0438786, 0.0172511, -0.010795, 0.0583502, 0.0571396, -0.020285, 0.0307382, -0.0552093, -0.0123484, -0.0536236, 0.0306536, -0.00906589, 0.0142038, 0.00630945, -0.0349821, 0.0310965, 0.063301, -0.0188871, 0.00905919, 0.00775627, 0.0438397, -0.00250775, 0.0352651, -0.0127834, 0.00489412, -0.0365417, -0.0957444, 0.0410595, -0.0494916, 0.0184773, 0.0643005, -0.00613315, 0.0166345, -0.0637133, 0.0980885, -0.00734111, 0.0193895, 0.0654734, 0.000617168, 0.000683704, 0.00656763, -0.00530976, 0.085809, 0.0150422, 0.00593754, 0.0789808, -0.0173614, 0.0419934, 0.0705892, 0.0216333, 0.0315913, -0.0416814}
	y = []float64{-0.0432802, -0.0249985, -0.110951, 0.00428246, -0.0167951, 0.0397216, 0.0394413, -0.0192296, -0.0735831, 0.00270305, 0.0183521, -0.0195025, -0.00159631, -0.116451, -0.00228179, -0.0159954, 0.0172275, -0.0311776, 8.93666e-05, -0.082187, -0.0320969, 0.0277126, 0.0133351, 0.111082, 0.0316058, 0.0405077, 0.0451943, -0.010158, 0.0453701, 0.0523159, -0.0653735, -0.0221929, -0.032738, 0.0188421, -0.0406526, 0.0878857, 0.0145818, 0.0359091, 0.0356156, -0.00431779, 0.00100935, -0.0294771, 0.0428615, -0.0691767, -0.0230771, 0.0374679, -0.0403584, -0.0616404, 0.0671505, 0.0682576, 0.00475728, 0.0537657, 0.0195006, 0.0509713, 0.00976284, 0.0196488, 0.0676201, -0.0198297, 0.0389066, 0.00641386, 0.042268, 0.0178646, -0.0187115, -0.0300575, 0.0966815, -0.0114963, -0.013489, -0.0144382, -0.0340636, 0.0740535, -0.0718685, 0.054713, 0.00446679, 0.0138883, 0.0200404, 0.0213551, -0.118384, -0.0302349, -0.067884, 0.0254836, -0.0398095, -0.0457225, 0.0390378, -0.00454634, 0.0580824, -0.0171528, -0.0887226, -0.0330608, 0.0319564, -0.0451445, 0.0640394, -0.00514243, -0.0337653, 0.0291763, 0.0222057, -0.0138703, 0.0412691, -0.0420718, 0.0256856, 0.0391314, -0.0809774, -0.102067, 0.00758102, -0.00210985, -0.0832995, -0.0375241, -0.0761081, -0.0271027, -0.00936455, 0.00719988, -0.0306357, 0.0404896, -0.000474075, -0.0490755, -0.0166276, -0.0633053, -0.0677101, -0.0436318, -0.0320842, 0.00457018, -0.00937922, 0.00334856, -0.0224879, -0.0264793, 0.031349, 9.59755e-05, -0.00678118, 0.0179256, -0.00626985, -0.0164371, -0.0327322, -0.00922855, -0.0013696, 0.0675855, -0.106325, -0.0228328, -0.000724285, 0.0388308, -0.0392852, 0.0439364, -0.0376358, -0.000298064, 0.0663644, 0.0173279, -0.0506753, -0.0108321, -0.0103146, -0.0395315, -0.00479823, 0.0123084, -0.00597645, 0.031826, 0.00802166, 0.0286628, 0.0327115, 0.0227644, -0.0319032, 0.0739196, 0.0810129, 0.021274, 0.0637079, -0.0311481, -0.0114604, 0.00850862, -0.0465776, 0.0116464, 0.0428967, -0.0957918, 0.0439522, -0.00644055, -0.0120108, 0.0294779, 0.0415648, -0.00915826, 0.029563, 0.0694238, 0.0698022, 0.0119586, -0.0314227, -0.0867263, -0.0115509, -0.0908532, -0.0291126, 0.0235958, -0.0644806, -0.000821673, 0.0482677, 0.0261907, -0.0503685, 0.0163156, -0.046486, -0.0219005, 0.00641334, -0.0777513, -0.116607, -0.0490293, 0.0389471, 0.0289699, -0.0559593, 0.0196923, -0.0853662, 0.0869303, -0.0150214, -0.0539145, 0.0288276, 0.0279616, -0.00471919, -0.119425, -0.0178961, 0.00123303, 0.0546437, 0.0198658, -0.0188171, -0.0016827, 0.00172954, 0.0147107, -0.0412129, -0.0395734, -0.0357421, -0.00143877, 0.00215682, -0.103421, -0.0484064, -0.0316824, -0.0117978, -0.104677, -0.027774, 0.0179924, 0.0369748, -0.0222853, 0.00452662, 0.071391, -0.0233622, -0.0288423, 0.0244839, -0.0668132, 0.050584, 0.0476267, -0.081407, -0.0367202, 0.0293687, -0.010642, -0.104972, -0.0129983, -0.00348046, 0.0345031, -0.00752244, 0.0437057, -0.0199162, -0.0106603, -0.000288127, 0.0302653, -0.00868213, 0.0135322, 0.0433927, -0.0301878, -0.0102612, -0.0516935, 0.062743, 0.0227401, 0.0663578, -0.0350265, -0.0381294, -0.0212181, -0.0115316, -0.058792, -0.0775783, 0.0194073, -0.0845483, -0.0767973, 0.0552471, 0.0520382, -0.0200858, 0.0417021, 0.054544, 0.049057, -0.0149085, 0.0311011, -0.0311079, 0.0167869, 0.0255707, -0.040528, -0.0495618, -0.0239548, -0.0701971, -0.0376588, -0.0193568, 0.038797, -0.0202898, -0.0220708, -0.0349169, -0.0457692, -0.0161989, 0.0209563, 0.0048236, -0.0596572, 0.00214464, 0.0530112, -0.00257605, 0.0144431, 0.0797701, -0.0138905, 0.0728356, -0.0392538, 0.034326, -0.0576501, 0.0642507, 0.0272024, 0.052831, -0.0273473, 0.0608718, -0.0380576, 0.00487148, -0.0204772, 0.0466436, 0.0547247, 0.000319749, 0.0279877, -0.0318242, 0.00703346, 0.0561087, -0.0357782, 0.0277316, 0.0121558, -0.00316783, 0.0065035, -0.0318191, -0.0775957, 0.00110566, -0.010713, 0.0527521, -0.0714251, 0.0363396, 0.0505514, -0.029468, 0.0211716, -0.0900377, -0.00196837, 0.0270888, 0.0927565, 0.0365816, -0.0117348, 0.00562731, -0.0361991, 0.0768149, -0.103413, -0.00949446, 0.00448937, 0.0622876, 0.00671747, -0.0567162, 0.0135227, -0.0600385, -0.0464641, -0.0265893, 0.0515229, 0.0192684, -0.0376813, -0.027001, -0.0133326, -0.0292275, -0.0601123, -0.0296438, -0.0144018, 0.0269942, 0.0102086, 0.078875, 0.0103493, -0.0364886, -0.0324563, 0.051013, 5.35422e-05, -0.0188326, -0.0390063, 0.00829547, -0.041771, 0.0308896, -0.0713144, -0.0931511, -0.0887023, 0.0151713, 0.0100141, 0.0101061, -0.00242393, -0.00460756, -0.0170676, -0.0261822, 0.013246, 0.0571856, 0.0282613, 0.0440924, 0.0393907, 0.00270928, -0.0120853, -0.0495719, -0.0353134, 0.0731424, 0.0117537, -0.0200328, 0.0187074, -0.0198134, 0.078508, -0.00590965, 0.0221198, -0.0281848, -0.00268927, 0.0182972, 0.0226141, -0.0691395, 0.0323855, -0.0175368, 0.0130863, -0.0290057, 0.0288457, 0.0425849, -0.0708698, 0.0326738, 0.0202882, -0.0535064, -0.00642091, -0.0265374, 0.0193205, -0.0146395, 0.00348586, -0.00439756, 0.0401034, 0.0989049, 0.04325, 0.0552656, 0.0333977, 0.0142844, 0.0682175, -0.0237616, -0.0169771, -0.00560633, -0.0526896, 0.0349004, -0.0172248, 0.0211818, -0.0246261, -0.035459, 0.051606, -0.0380285, -0.0291474, -0.0416274, 0.0156103, 0.00299726, 0.097948, -0.0612534, -0.0272312, 0.0228435, -0.0165679, 0.059955, -0.061834, -0.0126667, 0.0314584, 0.069373, 0.0555284, 0.0255292, -0.00811611, -0.0476943, 0.0667318, -0.018307, 0.0708573, 0.049949, -0.0332266, 0.0284483, -0.0534372, -0.0078497, -0.107483, 0.00736521, -0.0386014, 0.00607947, 0.0355906, -0.0135477, 0.0163739, 0.0577072, 0.00883407, -0.00405247, -0.0756945, 0.0686966, -0.0246948, 0.0319383, -0.0742191, -0.0150219, 0.00408864, -0.0576916, 0.0357812, -0.129759, 0.0287258, 0.0757937, -0.0128334, 0.0662667, -0.0182896, 0.0872745, 0.0368287, -0.0340271, 0.00777513, 0.0152324, 0.00432086, 0.0105216, -0.0107475, 0.0818931, 0.0312415, 0.0274849, 0.0414021, 0.0164209, 0.0675819, 0.08049, 0.0117553, 0.00562805, -0.0181759}
	y = []float64{0.0469585, -0.0626706, -0.074547, 0.034159, -0.0136994, 0.032714, 0.0205581, 0.00294838, -0.0656805, -0.0496715, -0.0230123, -0.0183961, -0.0126236, -0.0853315, 0.00749086, -0.0300594, 0.0187966, 0.0115344, -0.0291108, -0.0916225, -0.0690896, 0.0366005, 0.0416721, 0.0647797, -0.043517, 0.0837009, 0.0477796, -0.0482913, -0.0217968, 0.00530054, -0.0476175, 0.0437383, -0.0159522, -0.0373734, -0.0380778, 0.0555787, -0.0211611, 0.034403, -0.0599583, -0.0207409, -0.00545873, -0.0142373, 0.0019238, -0.0952906, 0.0420307, -0.0132151, -0.0308082, 0.00271665, -0.0365423, 0.0258867, 0.00785369, 0.0903904, 0.0051551, 0.0456352, -0.0850162, 0.0354394, 0.0592505, -0.00473704, 0.0733206, 0.0286715, 0.0269238, 0.0120826, 0.0422105, -0.0276666, 0.0537023, 0.0517941, 0.00628422, -0.0452092, 0.0129196, 0.0658373, -0.0334134, 0.0395802, 0.0413869, 0.0142818, -0.00433551, 0.00865623, -0.0867027, -0.0781174, -0.0460374, 0.0370357, 0.0225236, 0.038032, 0.0233102, 0.0139928, 0.0348535, -0.0262379, -0.000952324, 0.000952459, 0.0224923, -0.0616819, 0.0136232, 0.00392621, 0.054396, -0.0133984, 0.0301065, -0.00652926, -0.0451925, -0.0564376, -0.0423545, -0.00494503, 0.00378956, -0.1115, -0.0424019, 0.038064, -0.0387536, 0.0200443, 0.00937786, -0.0457028, -0.0423159, -0.0609591, -0.0219746, 0.0284168, -0.0806759, -0.0413402, 7.19944e-05, -0.101862, -0.0397519, -0.0734085, -0.0414264, 0.0272391, -0.070426, -0.0254755, -0.0605675, -0.0410438, -0.0349489, -0.0560472, -0.0248782, 0.0162341, 0.0163243, -0.0195443, -0.0355694, -0.0980111, 0.0189214, 0.00396002, -0.141668, 0.0208024, -0.0197534, -0.00297612, 0.0127773, 0.0567984, 0.0420703, 0.0728895, 0.0238576, 0.0568109, -0.0121361, -0.0428027, -0.00263842, -0.0550176, -0.0173326, 0.102956, -0.0226799, 0.00598857, -0.0447403, 0.0213433, 0.0514156, -0.0164112, -0.0197846, 0.022727, 0.0614701, -0.0335922, 0.0718227, -0.0289203, -0.0173924, 0.0264479, -0.0224477, -0.0161154, -0.0185127, -0.0221614, 0.0346164, -0.0309022, 0.000774626, 0.0268992, -0.028267, -0.0181992, 0.00832579, 0.0888055, 0.0159197, 0.00731788, -0.0310819, -0.00957044, -0.0644648, -0.0600991, -0.0330039, -0.0167641, 0.00101956, -0.00869434, -0.0144464, 0.0333883, 0.00242264, 0.0184308, -0.00364334, -0.0401845, 0.0427308, -0.0573257, -0.0295613, -0.0192749, 0.0623329, -0.00124865, -0.0478903, 0.00241227, -0.00547158, 0.0845192, -0.0485204, 0.00243069, 0.022045, 0.00724255, 0.0185485, -0.07397, -0.0317525, 0.0413703, 0.073881, 0.00686675, -0.033463, 0.0444171, -0.0291762, 0.0219066, -0.0469804, 0.0113664, -0.0380772, 0.0630469, -0.00817809, -0.0730729, -0.0765065, 0.0139913, 0.0152513, -0.07869, -0.0521043, 0.00797461, -0.0349845, -0.0178581, 0.0626926, 0.0631601, -0.00984445, -0.113548, -0.0185857, -0.0386081, 0.0210742, 0.0660637, -0.029929, -0.111216, 0.0768164, -0.0536929, -0.0453364, -0.0127397, 0.0263515, 0.0476482, 0.0374079, 0.0247702, 0.000446255, 0.0175882, -0.026275, 0.0123582, -0.012334, 0.0405208, 0.0332023, -0.0375874, -0.0332967, -0.00673241, 0.000404593, 0.059589, 0.107211, -0.00663578, 0.0097218, -0.0536941, -0.0216797, -0.0290865, -0.031077, -0.00461612, -0.0627464, -0.055446, 0.0344237, 0.0199944, 0.0299589, -0.0363541, 0.0622411, 0.00754571, -0.010668, -0.0337672, -0.00526423, 0.0266853, 0.037238, -0.032504, -0.0856757, -0.102723, -0.109537, 0.00935416, -0.020291, 0.0490099, -0.0223452, -0.0398408, -0.0435389, -0.0418623, 0.0558363, -0.0230925, 0.0238405, -0.0729415, 0.00162625, 0.025794, 0.026185, -0.000928349, 0.093564, -0.0591258, 0.106317, -0.0595589, 0.00238882, -0.0259337, 0.00241161, -0.0215468, 0.0437703, 0.0442601, 0.0401778, -0.0127241, 0.00727881, -0.0027969, 0.0139352, 0.0703737, -0.0334807, 0.0521084, -0.0289373, -0.0145478, 0.0920822, -0.0500793, 0.0293354, 0.0121277, 0.0067416, -0.0333916, -0.0298152, -0.0207268, 0.0115413, 0.00816639, 0.0773684, 0.00595563, 0.0446234, 0.0675549, -0.00015886, 0.0308256, -0.0615968, -0.0209978, 0.0391107, -0.00778241, 0.000473276, -0.0070726, 0.0248214, -0.0675451, 0.0214466, -0.0702658, 0.00828404, 0.0499315, 0.0521128, -0.00427589, -0.0701326, -0.00576914, -0.0452822, -0.0687393, -0.0892961, 0.0967513, 0.0397091, -0.0491705, 0.016041, 0.0441703, -0.0495669, 0.0390121, 0.000990183, 0.0125845, -0.0265836, 0.0286097, 0.105749, 0.0216709, 0.0237745, -0.0548263, 0.0254818, 0.0445848, -0.000843845, 0.0246318, -0.0194566, 0.0524527, 0.00781453, 0.00418642, -0.0765382, -0.0803568, -0.0339412, 0.0112371, -0.0280335, 0.00283328, 0.0368654, 0.00315365, 0.0144513, -0.048423, 0.0149586, -0.0168541, 0.042482, -0.00146698, -0.0239033, -0.0500191, -0.0474935, 0.00454268, 0.040928, 0.0299227, -0.0604738, -0.00109149, -0.0578273, 0.0427367, -0.0863228, 0.0763742, -0.0306324, -0.0130911, -0.0245796, -0.0674011, -0.0550069, 0.0365482, 0.0215687, 0.00488035, 0.0246296, 0.0112948, 0.0449203, -0.00773394, 0.0137186, 0.0242258, -0.0744329, 0.017067, -0.030684, 0.00228082, -0.00708048, -0.000438091, -0.0156949, -0.00477164, 0.0750796, 0.0586857, 0.0634546, -0.0240535, -0.0573679, 0.00799506, -0.0386297, -0.103406, -0.0724986, -0.0283712, -0.00315585, 0.0283858, 0.0738228, 0.00450534, -0.0739646, 0.0371634, -0.0441648, 0.0329536, -0.0264073, -0.0114566, -0.0135762, 0.0835204, -0.0983007, -0.0310485, -0.0205355, 0.0224738, 0.0409215, -0.0909232, -0.032763, 0.0102421, 0.0139311, 0.0640552, 0.0269954, 0.0531415, -0.0670077, 0.0607827, 0.0247984, 0.0577885, 0.0380434, -0.0169995, 0.0217253, -0.00853537, 0.032587, -0.0867543, 0.0278529, -0.0027145, 0.0318975, 0.0203426, -0.0657906, -0.00112051, 0.0393874, -0.00538886, 0.0161849, -0.0683567, 0.0262893, -0.0336675, 0.0773007, -0.038617, 0.0237346, 0.0253314, -0.10731, 0.00597037, -0.0520326, -0.00979369, 0.0430284, -0.0205096, 0.0558709, -0.0816714, 0.0739463, -0.0504966, 0.00186421, -0.026121, 0.0302524, -0.0172939, -0.00212395, 0.0139075, -0.0382663, 0.0480257, 0.00299394, 0.0575153, 0.0284158, 0.0255311, 0.00224682, 0.00493889, -0.0153862, -0.0541975}

	start := time.Now()
	r := cal(x, y)
	fmt.Println(time.Since(start).Seconds())

	r1 := cal(x[0:256], y[0:256])
	r2 := cal(x[0:256], y[256:512])
	r3 := cal(x[256:512], y[0:256])
	r4 := cal(x[256:512], y[256:512])
fmt.Printf("%f, %f, %f, %f, %f, %f, %t",r, r1, r2, r3, r4,r1+r2+r3+r4, r == (r1+r2+r3+r4))

	//mkl.SetNumThreads(1)

	start = time.Now()
	for i := 0; i < 1000000; i++ {
		cal(x, y)
	}
	fmt.Println(time.Since(start).Seconds())

	start = time.Now()
	for i := 0; i < 10000000; i++ {
		cal(x, y)
	}
	fmt.Println(time.Since(start).Seconds())

	test(100, 100000)
	test(100, 1000000)
	test(100, 10000000)

	start = time.Now()
	for i := 0; i < 100; i++ {
		cal(x, y)
	}
	fmt.Printf("%.9f\n", time.Since(start).Seconds())

	//cal(y, x)
}

func test(goCount, dataCount int) {
	x := []float64{-0.0171471, 0.0297846, -0.0783937, 0.0344659, -0.0123615, -0.01626, 0.00834311, -0.0131212, -0.0737021, 4.94058e-05, -0.0295938, -0.0375178, -0.00589015, -0.0987369, -0.0100861, -0.0495452, 0.0372468, 0.0223542, -0.0248803, -0.082314, -0.0363815, 0.0716982, -0.00636599, 0.115157, 0.0063867, 0.0512754, 0.0208855, -7.58288e-05, 0.0538642, 0.0682479, -0.0838593, -0.00861104, -0.00883072, -0.0507958, -0.00559831, 0.0520896, 0.00130107, 0.00808368, 0.00678698, -0.0151102, -0.0329421, 0.00127409, 0.0677626, -0.0885619, -0.0121525, 0.0388406, -0.0474348, -0.0283509, 0.00531573, 0.062828, 0.0204233, 0.0347214, 0.00650341, 0.0209573, 0.000961383, -0.00662436, 0.0138615, 0.0345118, 0.0697092, -0.000791458, 0.0484601, 0.0272089, 0.0123456, -0.0561579, 0.0128478, 0.00634787, -0.00798256, 0.0608229, -0.00798005, 0.120746, -0.0189326, 0.0783079, -0.0112193, 0.046667, 0.0295899, -0.0624849, -0.124728, 0.00555878, -0.016878, 0.014625, 0.0279958, 0.000402037, 0.0477066, -0.00460424, -0.0253392, -0.0320167, -0.0529004, -0.0229253, 0.0343391, -0.0616839, 0.0666866, 0.0144988, 0.0290018, 0.0212762, 0.035475, 0.00542536, 0.0545873, -0.0314021, -0.00240926, 0.0128215, -0.0672244, -0.0794786, -0.0331857, -0.00343452, -0.0740348, -0.0263932, -0.0200069, -0.0450306, -0.0134022, 0.00790044, 0.00848116, 0.0372897, -0.000965439, -0.0345475, 0.0274444, -0.0795713, 0.013695, -0.0463269, -0.07119, 0.000392504, -0.023657, 0.0663353, -0.053157, -0.0631605, 0.0186122, 0.0207092, -0.00495913, 0.038306, 0.00828956, 0.0375084, -0.0147441, -0.0299766, 0.0326492, 0.0315515, -0.100865, -0.051241, -0.0306122, 0.0357479, 0.0152679, 0.0767074, -0.034078, 0.0125329, 0.0623144, 0.0255483, -0.0349576, -0.00636306, -0.0091572, -0.0857235, 0.0147058, 0.0213435, 0.00918211, -0.0264534, -0.0174918, 0.042121, 0.0456522, -0.0467863, -0.0586724, -0.00362923, 0.0297368, -0.00128466, 0.0601085, -0.0407007, 0.00304022, 0.0427377, -0.0338262, 0.0209174, 0.0232725, -0.0635804, 0.00294901, -0.00688292, -0.035485, 0.00681437, 0.00419963, 0.0296707, -0.00966988, 0.0829466, 0.0987125, 0.0632617, 0.0186468, -0.0888392, -0.0319501, -0.138817, 0.000794682, 0.016008, -0.0229171, 0.0435127, 0.0192899, 0.0100671, 0.0160915, 0.0770807, 0.0210978, -0.0227231, 0.0213188, -0.0295822, -0.0496281, -0.0348551, 0.0130301, 0.00616363, -0.0528773, -0.00137729, -0.069117, 0.0572823, -0.0267041, -0.0236668, 0.0426983, 0.00557249, 0.0231821, -0.0574522, -0.0355684, -0.0263657, 0.0631605, 0.0202925, 0.000604569, 0.0577102, 0.0223738, 0.033917, -0.026992, -0.021749, -0.106903, 0.0216692, -0.030522, -0.0868955, -0.114403, -0.0154236, -0.0240191, -0.0736906, -0.025687, 0.053966, 0.0419866, -0.0191384, 0.0404638, 0.0509841, -0.0211946, -0.078684, -0.0189793, -0.0382228, -0.0133259, 0.0769548, -0.0232762, -0.0746178, 0.0372208, -0.00432725, -0.0737898, 0.0213405, 0.0274398, 0.02592, 0.0668217, 0.0601869, -0.00129789, -0.00758273, -0.0312531, 0.0161658, -0.0340317, -0.00453943, 0.0169883, -0.044012, 0.00568949, -0.0422528, 0.0255397, 0.0058966, 0.0464304, -0.0379761, -0.0185769, -0.0513068, 0.00520705, -0.0661553, -0.0693925, 0.0724979, -0.0370124, -0.0566514, 0.071927, 0.0148165, 0.0519497, 0.0605697, 0.0320238, 0.000505405, 0.0436917, 0.0645559, 0.0260267, -0.0118016, 0.0398527, -0.0362457, -0.0466475, -0.0736472, -0.0366584, -0.0266992, -0.0120547, 0.0260854, -0.0601956, -0.0351302, -0.0837961, -0.055995, -0.0217101, 0.00650347, 0.00601037, -0.0740694, 0.00353488, 0.0313742, 0.00895211, 0.00543229, 0.117694, -0.0519126, 0.0943572, -0.0217035, 0.0428975, -0.00795407, 0.0543104, -0.0617965, 0.0676821, 0.0506659, 0.0853076, 0.040125, 0.0353153, 0.0341825, 0.0673648, 0.00194593, -0.0537658, 0.0368877, -0.0555215, 0.00214208, 0.0628353, -0.0230826, 0.0159762, 0.0718393, -0.0353398, -0.0177154, -0.0522304, -0.0649052, -0.00381502, -0.0185878, 0.0230481, -0.0463684, 0.0311793, 0.0382167, -0.0476014, -0.0373729, -0.0984441, -0.0260586, 0.0489026, 0.0638859, 0.0475757, 0.0238389, -0.019363, -0.066169, 0.0679463, -0.0673361, -0.0437612, 0.00600675, 0.11779, -0.0202437, -0.0269992, 0.00462337, -0.0617419, -0.0334796, -0.084388, 0.0715167, 0.0305015, 0.000284642, 0.0273472, -0.0176894, -0.0440895, -0.0058093, -0.0380236, 0.0113413, 0.0255854, -0.00966855, 0.0632864, -0.00997986, -0.0513677, -0.0355007, 0.0202677, -0.0128693, -0.0222251, -0.0236273, 0.0438018, 0.049972, 0.000851075, -0.039514, -0.0980734, -0.0474352, 0.0402889, -0.00253022, 0.0129111, 0.0359259, 0.0446692, 0.0157924, -0.0319146, -0.0254299, 0.0388774, 0.0262729, 0.0153477, 0.0520895, 0.0154867, -0.00149737, -0.0574799, -0.00183617, 0.0835947, 0.0504391, -0.0276789, 0.0476432, -0.0398327, 0.0532539, -0.0217112, 0.0839872, -0.00940199, -0.0626493, -0.0145271, 0.0174366, -0.0422386, 0.042953, 0.000379637, 0.00689239, -0.0244376, 0.0507345, 0.0368854, -0.0109072, 0.0304436, 0.066979, -0.0422741, -0.0102804, -0.0497968, -0.00431522, 0.00114161, -0.0262222, -0.0389814, 0.0169792, 0.115477, 0.0337423, -0.0143487, 0.0528054, -0.0154762, 0.0499573, -0.0508829, -0.0336813, 0.00646144, 0.0229013, -0.0132276, 0.00992374, 0.0888671, 0.0234773, -0.0190414, 0.0322071, -0.0226155, -0.0109756, -0.0160802, 0.0307243, -0.0243819, 0.114929, -0.0106829, -0.0599759, -0.00924507, -0.0127293, 0.0348296, -0.0951476, -0.00835151, 0.0566157, 0.027921, 0.0178862, 0.00843341, -0.0118943, -0.0438786, 0.0172511, -0.010795, 0.0583502, 0.0571396, -0.020285, 0.0307382, -0.0552093, -0.0123484, -0.0536236, 0.0306536, -0.00906589, 0.0142038, 0.00630945, -0.0349821, 0.0310965, 0.063301, -0.0188871, 0.00905919, 0.00775627, 0.0438397, -0.00250775, 0.0352651, -0.0127834, 0.00489412, -0.0365417, -0.0957444, 0.0410595, -0.0494916, 0.0184773, 0.0643005, -0.00613315, 0.0166345, -0.0637133, 0.0980885, -0.00734111, 0.0193895, 0.0654734, 0.000617168, 0.000683704, 0.00656763, -0.00530976, 0.085809, 0.0150422, 0.00593754, 0.0789808, -0.0173614, 0.0419934, 0.0705892, 0.0216333, 0.0315913, -0.0416814}
	y := []float64{-0.0432802, -0.0249985, -0.110951, 0.00428246, -0.0167951, 0.0397216, 0.0394413, -0.0192296, -0.0735831, 0.00270305, 0.0183521, -0.0195025, -0.00159631, -0.116451, -0.00228179, -0.0159954, 0.0172275, -0.0311776, 8.93666e-05, -0.082187, -0.0320969, 0.0277126, 0.0133351, 0.111082, 0.0316058, 0.0405077, 0.0451943, -0.010158, 0.0453701, 0.0523159, -0.0653735, -0.0221929, -0.032738, 0.0188421, -0.0406526, 0.0878857, 0.0145818, 0.0359091, 0.0356156, -0.00431779, 0.00100935, -0.0294771, 0.0428615, -0.0691767, -0.0230771, 0.0374679, -0.0403584, -0.0616404, 0.0671505, 0.0682576, 0.00475728, 0.0537657, 0.0195006, 0.0509713, 0.00976284, 0.0196488, 0.0676201, -0.0198297, 0.0389066, 0.00641386, 0.042268, 0.0178646, -0.0187115, -0.0300575, 0.0966815, -0.0114963, -0.013489, -0.0144382, -0.0340636, 0.0740535, -0.0718685, 0.054713, 0.00446679, 0.0138883, 0.0200404, 0.0213551, -0.118384, -0.0302349, -0.067884, 0.0254836, -0.0398095, -0.0457225, 0.0390378, -0.00454634, 0.0580824, -0.0171528, -0.0887226, -0.0330608, 0.0319564, -0.0451445, 0.0640394, -0.00514243, -0.0337653, 0.0291763, 0.0222057, -0.0138703, 0.0412691, -0.0420718, 0.0256856, 0.0391314, -0.0809774, -0.102067, 0.00758102, -0.00210985, -0.0832995, -0.0375241, -0.0761081, -0.0271027, -0.00936455, 0.00719988, -0.0306357, 0.0404896, -0.000474075, -0.0490755, -0.0166276, -0.0633053, -0.0677101, -0.0436318, -0.0320842, 0.00457018, -0.00937922, 0.00334856, -0.0224879, -0.0264793, 0.031349, 9.59755e-05, -0.00678118, 0.0179256, -0.00626985, -0.0164371, -0.0327322, -0.00922855, -0.0013696, 0.0675855, -0.106325, -0.0228328, -0.000724285, 0.0388308, -0.0392852, 0.0439364, -0.0376358, -0.000298064, 0.0663644, 0.0173279, -0.0506753, -0.0108321, -0.0103146, -0.0395315, -0.00479823, 0.0123084, -0.00597645, 0.031826, 0.00802166, 0.0286628, 0.0327115, 0.0227644, -0.0319032, 0.0739196, 0.0810129, 0.021274, 0.0637079, -0.0311481, -0.0114604, 0.00850862, -0.0465776, 0.0116464, 0.0428967, -0.0957918, 0.0439522, -0.00644055, -0.0120108, 0.0294779, 0.0415648, -0.00915826, 0.029563, 0.0694238, 0.0698022, 0.0119586, -0.0314227, -0.0867263, -0.0115509, -0.0908532, -0.0291126, 0.0235958, -0.0644806, -0.000821673, 0.0482677, 0.0261907, -0.0503685, 0.0163156, -0.046486, -0.0219005, 0.00641334, -0.0777513, -0.116607, -0.0490293, 0.0389471, 0.0289699, -0.0559593, 0.0196923, -0.0853662, 0.0869303, -0.0150214, -0.0539145, 0.0288276, 0.0279616, -0.00471919, -0.119425, -0.0178961, 0.00123303, 0.0546437, 0.0198658, -0.0188171, -0.0016827, 0.00172954, 0.0147107, -0.0412129, -0.0395734, -0.0357421, -0.00143877, 0.00215682, -0.103421, -0.0484064, -0.0316824, -0.0117978, -0.104677, -0.027774, 0.0179924, 0.0369748, -0.0222853, 0.00452662, 0.071391, -0.0233622, -0.0288423, 0.0244839, -0.0668132, 0.050584, 0.0476267, -0.081407, -0.0367202, 0.0293687, -0.010642, -0.104972, -0.0129983, -0.00348046, 0.0345031, -0.00752244, 0.0437057, -0.0199162, -0.0106603, -0.000288127, 0.0302653, -0.00868213, 0.0135322, 0.0433927, -0.0301878, -0.0102612, -0.0516935, 0.062743, 0.0227401, 0.0663578, -0.0350265, -0.0381294, -0.0212181, -0.0115316, -0.058792, -0.0775783, 0.0194073, -0.0845483, -0.0767973, 0.0552471, 0.0520382, -0.0200858, 0.0417021, 0.054544, 0.049057, -0.0149085, 0.0311011, -0.0311079, 0.0167869, 0.0255707, -0.040528, -0.0495618, -0.0239548, -0.0701971, -0.0376588, -0.0193568, 0.038797, -0.0202898, -0.0220708, -0.0349169, -0.0457692, -0.0161989, 0.0209563, 0.0048236, -0.0596572, 0.00214464, 0.0530112, -0.00257605, 0.0144431, 0.0797701, -0.0138905, 0.0728356, -0.0392538, 0.034326, -0.0576501, 0.0642507, 0.0272024, 0.052831, -0.0273473, 0.0608718, -0.0380576, 0.00487148, -0.0204772, 0.0466436, 0.0547247, 0.000319749, 0.0279877, -0.0318242, 0.00703346, 0.0561087, -0.0357782, 0.0277316, 0.0121558, -0.00316783, 0.0065035, -0.0318191, -0.0775957, 0.00110566, -0.010713, 0.0527521, -0.0714251, 0.0363396, 0.0505514, -0.029468, 0.0211716, -0.0900377, -0.00196837, 0.0270888, 0.0927565, 0.0365816, -0.0117348, 0.00562731, -0.0361991, 0.0768149, -0.103413, -0.00949446, 0.00448937, 0.0622876, 0.00671747, -0.0567162, 0.0135227, -0.0600385, -0.0464641, -0.0265893, 0.0515229, 0.0192684, -0.0376813, -0.027001, -0.0133326, -0.0292275, -0.0601123, -0.0296438, -0.0144018, 0.0269942, 0.0102086, 0.078875, 0.0103493, -0.0364886, -0.0324563, 0.051013, 5.35422e-05, -0.0188326, -0.0390063, 0.00829547, -0.041771, 0.0308896, -0.0713144, -0.0931511, -0.0887023, 0.0151713, 0.0100141, 0.0101061, -0.00242393, -0.00460756, -0.0170676, -0.0261822, 0.013246, 0.0571856, 0.0282613, 0.0440924, 0.0393907, 0.00270928, -0.0120853, -0.0495719, -0.0353134, 0.0731424, 0.0117537, -0.0200328, 0.0187074, -0.0198134, 0.078508, -0.00590965, 0.0221198, -0.0281848, -0.00268927, 0.0182972, 0.0226141, -0.0691395, 0.0323855, -0.0175368, 0.0130863, -0.0290057, 0.0288457, 0.0425849, -0.0708698, 0.0326738, 0.0202882, -0.0535064, -0.00642091, -0.0265374, 0.0193205, -0.0146395, 0.00348586, -0.00439756, 0.0401034, 0.0989049, 0.04325, 0.0552656, 0.0333977, 0.0142844, 0.0682175, -0.0237616, -0.0169771, -0.00560633, -0.0526896, 0.0349004, -0.0172248, 0.0211818, -0.0246261, -0.035459, 0.051606, -0.0380285, -0.0291474, -0.0416274, 0.0156103, 0.00299726, 0.097948, -0.0612534, -0.0272312, 0.0228435, -0.0165679, 0.059955, -0.061834, -0.0126667, 0.0314584, 0.069373, 0.0555284, 0.0255292, -0.00811611, -0.0476943, 0.0667318, -0.018307, 0.0708573, 0.049949, -0.0332266, 0.0284483, -0.0534372, -0.0078497, -0.107483, 0.00736521, -0.0386014, 0.00607947, 0.0355906, -0.0135477, 0.0163739, 0.0577072, 0.00883407, -0.00405247, -0.0756945, 0.0686966, -0.0246948, 0.0319383, -0.0742191, -0.0150219, 0.00408864, -0.0576916, 0.0357812, -0.129759, 0.0287258, 0.0757937, -0.0128334, 0.0662667, -0.0182896, 0.0872745, 0.0368287, -0.0340271, 0.00777513, 0.0152324, 0.00432086, 0.0105216, -0.0107475, 0.0818931, 0.0312415, 0.0274849, 0.0414021, 0.0164209, 0.0675819, 0.08049, 0.0117553, 0.00562805, -0.0181759}

	start := time.Now()
	wg := sync.WaitGroup{}
	for j := 0; j < goCount; j++ {
		wg.Add(1)
		go func() {
			for i := 0; i < dataCount; i++ {
				cal(x, y)
			}
			wg.Done()
		}()
	}
	wg.Wait()
	fmt.Println(time.Since(start).Seconds())
}

func cal(x, y []float64) float64 {
	n, incx, incy := 512, 1, 1
	return mkl.Ddot(n, x, incx, y, incy)
}
